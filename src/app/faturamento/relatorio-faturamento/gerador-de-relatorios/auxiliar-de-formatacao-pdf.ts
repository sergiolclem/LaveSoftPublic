import * as moment from 'moment';

import * as jspdf from 'jspdf';
import 'jspdf-autotable';
import { UserOptions } from 'jspdf-autotable';

interface jsPDFPlugin extends jspdf {
    autoTable: (options: UserOptions) => jspdf;
}

// Constantes EMPRESA
const LOGO = 'data:image/png;base64,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';
const CONTATO = '31 9 8543 - 2721';
const ENDERECO = 'Rua Vitorio Zanetti, 70, Lagoa, OP';
const EMAIL = 'laveelimpeop@gmail.com';
const CNPJ = 'CNPJ: 33.101.607/0001-17';
// Constantes WINDOW
const TOP = 60;
const LEFT = 30;

const MESES = [
    'Janeiro',
    'Fevereiro',
    'Março',
    'Abril',
    'Maio',
    'Junho',
    'Julho',
    'Agosto',
    'Setembro',
    'Outubro',
    'Novembro',
    'Dezembro',
]

export class AuxiliarFormatacaoPDF {

    static gerarRelatorio(relFat) {
        var doc = new jspdf('landscape', 'px', 'a4') as jsPDFPlugin;

        this.gerarRelatorioServicos(doc, relFat);
        this.gerarTotalizadores(doc, relFat);

        var nomeArquivo = this.getNomeArquivo(relFat);
        doc.save(nomeArquivo);
    }

    private static gerarRelatorioServicos(doc: jsPDFPlugin, relFat) {
        this.adicionarCabecalho(doc, relFat);
        doc.autoTable({
            startY: 120,
            head: relFat.relatorioServicos.rotulos,
            body: relFat.relatorioServicos.linhasDeFaturamento
        })
    }

    private static gerarTotalizadores(doc: jsPDFPlugin, relFat) {
        doc.addPage("a4", "landscape");
        this.adicionarCabecalho(doc, relFat);
        doc.autoTable({
            startY: 120,
            head: relFat.totalizadores.rotulos,
            body: this.configurarMoedas(relFat.totalizadores.linhasDeTotais),
            foot: this.configurarMoedas(relFat.totalizadores.rodape)
        });
    }

    private static configurarMoedas(linhas) {
        linhas.forEach(linha => {
            linha[2] = linha[2].toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })
            linha[3] = linha[3].toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })
        })
        return linhas
    }

    private static adicionarCabecalho(doc: jsPDFPlugin, relFat) {
        doc.addImage(LOGO, 'PNG', 480, 50);
        this.adicionarTextos(doc, relFat)
    }

    private static adicionarTextos(doc: jsPDFPlugin, relFat) {

        var clienteTxt = 'Cliente: ' + relFat.cliente.infoPrincipais.nome;
        var mesTxt = '- ' + this.getMesReferencia(relFat);

        doc.setFont('helvetica');
        doc.setTextColor(14, 33, 55);
        doc.setFontSize(11);

        doc.text(CONTATO, LEFT, TOP);
        doc.text(ENDERECO, LEFT, TOP + 10);
        doc.text(EMAIL, LEFT, TOP + 20);
        doc.text(CNPJ, LEFT, TOP + 30);

        doc.setFontSize(16);
        doc.text(clienteTxt, LEFT, TOP + 50);
        doc.text(mesTxt, LEFT + doc.getTextWidth(clienteTxt) + 5, TOP + 50);
    }

    private static getNomeArquivo(relFat) {
        return [
            relFat.cliente.infoPrincipais.nome, 
            this.getMesReferencia(relFat),
            'Relatório'
        ].join(' ')
    }

    private static getMesReferencia(relFat) {
        var mesInt = moment(relFat.relatorioServicos.rotulos[0][1], "DD-MM").month();
        return MESES[mesInt];
    }
}
